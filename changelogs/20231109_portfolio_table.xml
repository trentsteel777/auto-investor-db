<?xml version="1.0" encoding="UTF-8"?>  
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
    xmlns:pro="http://www.liquibase.org/xml/ns/pro"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd
        http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-latest.xsd">

	<changeSet id="7" author="trentsteel777">
		<createTable tableName="ACCOUNTS">
			<column name="ID" type="SERIAL">
				<constraints primaryKey="true"/>
			</column>
			<column name="ACCOUNT_NUMBER" type="VARCHAR(10)">
				<constraints nullable="false"/>
			</column>
			<column name="CREATED_DATE" type="DATE">
				<constraints nullable="false"/>
			</column>
			<column name="MODIFIED_DATE" type="DATE"/>
		</createTable>
		<rollback>
			<dropTable tableName="ACCOUNTS"/>
		</rollback>
	</changeSet>
	
	<changeSet id="8" author="trentsteel777">
		<createTable tableName="POSITIONS">
			<column name="ID" type="SERIAL">
				<constraints primaryKey="true"/>
			</column>
			<column name="ACCOUNT_NUMBER_ID" type="SERIAL">
				<constraints foreignKeyName="POSITIONS_ACCOUNT_NUMBER_ID_FK" referencedTableName="ACCOUNTS" referencedColumnNames="ID" nullable="false"/>
			</column>
			<column name="OPTION_ID" type="BIGSERIAL">
				<constraints foreignKeyName="POSITIONS_OPTION_ID_FK" referencedTableName="OPTIONS" referencedColumnNames="ID" nullable="false"/>
			</column>
			<column name="QUANTITY" type="INT">
				<constraints nullable="false"/>
			</column>
			<column name="CREATED_DATE" type="DATE">
				<constraints nullable="false"/>
			</column>
			<column name="MODIFIED_DATE" type="DATE"/>
		</createTable>
		<rollback>
			<dropTable tableName="POSITIONS"/>
		</rollback>
	</changeSet>
	
	<changeSet id="9" author="trentsteel777">
		<createTable tableName="CASH_POSITIONS">
			<column name="ID" type="SERIAL">
				<constraints primaryKey="true"/>
			</column>
			<column name="ACCOUNT_NUMBER_ID" type="SERIAL">
				<constraints foreignKeyName="CASH_POSITIONS_ACCOUNT_NUMBER_ID_FK" referencedTableName="ACCOUNTS" referencedColumnNames="ID" nullable="false"/>
			</column>
			<column name="CURRENCY" type="VARCHAR(10)">
				<constraints nullable="false"/>
			</column>
			<column name="AMOUNT" type="DECIMAL(10, 2)">
				<constraints nullable="false"/>
			</column>
			<column name="CREATED_DATE" type="DATE">
				<constraints nullable="false"/>
			</column>
			<column name="MODIFIED_DATE" type="DATE"/>
		</createTable>
		<rollback>
			<dropTable tableName="CASH_POSITIONS"/>
		</rollback>
	</changeSet>
	
	<changeSet id="10" author="trentsteel777">
		<insert tableName="ACCOUNTS">
			<column name="ID" valueNumeric="1"/>
			<column name="ACCOUNT_NUMBER" value="0000000001"/>
			<column name="CREATED_DATE" valueDate="CURRENT_DATE"/>
			<column name="MODIFIED_DATE"/>
		</insert>
		<rollback>
			<delete tableName="ACCOUNTS">
				<where> ID=1 </where>
			</delete>
		</rollback>
	</changeSet>
	
	<changeSet id="11" author="trentsteel777">
		<insert tableName="CASH_POSITIONS">
			<column name="ID" valueNumeric="1"/>
			<column name="ACCOUNT_NUMBER_ID" valueNumeric="1"/>
			<column name="CURRENCY" value="USD"/>
			<column name="AMOUNT" valueNumeric="100000.00"/>
			<column name="CREATED_DATE" valueDate="CURRENT_DATE"/>
			<column name="MODIFIED_DATE"/>
		</insert>
		<rollback>
			<delete tableName="CASH_POSITIONS">
				<where> ID=1 </where>
			</delete>
		</rollback>
	</changeSet>

	<changeSet id="12" author="trentsteel777">
		<insert tableName="OPTIONS">
			<column name="SYMBOL" value="TEST"/>
			<column name="OPTION_TYPE_ID" valueNumeric="0"/>
			<column name="CONTRACT_SYMBOL" value="AAPL202301C150"/>
			<column name="STRIKE" valueNumeric="150.0"/>
			<column name="CURRENCY" value="USD"/>
			<column name="LAST_PRICE" valueNumeric="10.5"/>
			<column name="CHANGE" valueNumeric="1.2"/>
			<column name="PERCENT_CHANGE" valueNumeric="12.0"/>
			<column name="VOLUME" valueNumeric="500"/>
			<column name="OPEN_INTEREST" valueNumeric="1000"/>
			<column name="BID" valueNumeric="10.2"/>
			<column name="ASK" valueNumeric="11.0"/>
			<column name="CONTRACT_SIZE" value="100"/>
			<column name="EXPIRATION" valueDate="2023-01-15"/>
			<column name="LAST_TRADE_DATE" valueDate="2023-11-06 14:30:00"/>
			<column name="IMPLIED_VOLATILITY" valueNumeric="0.25"/>
			<column name="IN_THE_MONEY" valueBoolean="true"/>
			<column name="CREATED_DATE" valueDate="2023-11-06"/>
		</insert>
		<rollback>
			<delete tableName="OPTIONS">
				<where> SYMBOL='TEST' </where>
			</delete>
		</rollback>
	</changeSet>

	<changeSet id="13" author="trentsteel777">
		<insert tableName="POSITIONS">
			<column name="ACCOUNT_NUMBER_ID" valueNumeric="1"/>
			<column name="OPTION_ID" valueComputed="(SELECT ID FROM OPTIONS WHERE CONTRACT_SYMBOL = 'AAPL202301C150')"/>
			<column name="QUANTITY" valueNumeric="10"/>
			<column name="CREATED_DATE" valueDate="CURRENT_DATE"/>
			<column name="MODIFIED_DATE"/>
		</insert>
		<rollback>
			<delete tableName="POSITIONS">
				<where> ACCOUNT_NUMBER_ID=1 </where>
			</delete>
		</rollback>
	</changeSet>


</databaseChangeLog>